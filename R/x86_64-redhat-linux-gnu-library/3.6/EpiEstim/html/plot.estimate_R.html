<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Plot outputs of estimate_r</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for plot.estimate_R {EpiEstim}"><tr><td>plot.estimate_R {EpiEstim}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>Plot outputs of estimate_r</h2>

<h3>Description</h3>

<p>The plot method of <code>estimate_r</code> objects can be used to visualise three
types of information. The first one shows the epidemic curve. The second one
shows the posterior mean and 95% credible interval of the reproduction
number. The estimate for a time window is plotted at the end of the time
window. The third plot shows the discrete distribution(s) of the serial
interval.
</p>


<h3>Usage</h3>

<pre>
## S3 method for class 'estimate_R'
plot(x, what = c("all", "incid", "R", "SI"),
  add_imported_cases = FALSE, options_I = list(col = palette(), transp
  = 0.7, xlim = NULL, ylim = NULL, interval = 1L, xlab = "Time", ylab =
  "Incidence"), options_R = list(col = palette(), transp = 0.2, xlim =
  NULL, ylim = NULL, xlab = "Time", ylab = "R"),
  options_SI = list(prob_min = 0.001, col = "black", transp = 0.25, xlim
  = NULL, ylim = NULL, xlab = "Time", ylab = "Frequency"), legend = TRUE,
  ...)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>x</code></td>
<td>
<p>The output of function <code><a href="estimate_R.html">estimate_R</a></code> or function
<code><a href="wallinga_teunis.html">wallinga_teunis</a></code>. To plot simultaneous outputs on the same 
plot use <code><a href="estimate_R_plots.html">estimate_R_plots</a></code> function</p>
</td></tr>
<tr valign="top"><td><code>what</code></td>
<td>
<p>A string specifying what to plot, namely the incidence time
series (<code>what='incid'</code>), the estimated reproduction number
(<code>what='R'</code>), the serial interval distribution (<code>what='SI'</code>, or
all three (<code>what='all'</code>)).</p>
</td></tr>
<tr valign="top"><td><code>add_imported_cases</code></td>
<td>
<p>A boolean to specify whether, on the incidence time
series plot, to add the incidence of imported cases.</p>
</td></tr>
<tr valign="top"><td><code>options_I</code></td>
<td>
<p>For what = &quot;incid&quot; or &quot;all&quot;. A list of graphical options:
</p>
 <dl>
<dt>col</dt><dd><p>A colour or vector of colours used for plotting
incid. By default uses the default R colours.</p>
</dd>  <dt>transp</dt><dd><p>A numeric
value between 0 and 1 used to monitor transparency of the bars
plotted. Defaults to 0.7.</p>
</dd>  <dt>xlim</dt><dd><p>A parameter similar to that in
<code>par</code>, to monitor the limits of the horizontal axis</p>
</dd> <dt>ylim</dt><dd><p>A
parameter similar to that in <code>par</code>, to monitor the limits of the
vertical axis</p>
</dd> <dt>interval</dt><dd><p>An integer or character indicating the 
(fixed) size of the time interval used for plotting the incidence; 
defaults to 1 day.</p>
</dd> <dt>xlab, ylab</dt><dd><p>Labels for the axes of the 
incidence plot</p>
</dd></dl>
</td></tr>
<tr valign="top"><td><code>options_R</code></td>
<td>
<p>For what = &quot;R&quot; or &quot;all&quot;. A list of graphical options:
</p>
 <dl>
<dt>col</dt><dd><p>A colour or vector of colours used for plotting R. By
default uses the default R colours.</p>
</dd>  <dt>transp</dt><dd><p>A numeric value between
0 and 1 used to monitor transparency of the 95%CrI. Defaults to 0.2.</p>
</dd>
<dt>xlim</dt><dd><p>A parameter similar to that in <code>par</code>, to monitor the
limits of the horizontal axis</p>
</dd> <dt>ylim</dt><dd><p>A parameter similar to that in
<code>par</code>, to monitor the limits of the vertical axis</p>
</dd> 
<dt>xlab, ylab</dt><dd><p>Labels for the axes of the R plot</p>
</dd></dl>
</td></tr>
<tr valign="top"><td><code>options_SI</code></td>
<td>
<p>For what = &quot;SI&quot; or &quot;all&quot;. A list of graphical options:
</p>
 <dl>
<dt>prob_min</dt><dd><p>A numeric value between 0 and 1. The SI
distributions explored are only shown from time 0 up to the time t so that
each distribution explored has probability &lt; <code>prob_min</code> to be on any
time step after t. Defaults to 0.001.</p>
</dd>  <dt>col</dt><dd><p>A colour or vector of
colours used for plotting the SI. Defaults to black.</p>
</dd>  <dt>transp</dt><dd><p>A
numeric value between 0 and 1 used to monitor transparency of the
lines. Defaults to 0.25</p>
</dd> <dt>xlim</dt><dd><p>A parameter similar to that in
<code>par</code>, to monitor the limits of the horizontal axis</p>
</dd> <dt>ylim</dt><dd><p>A
parameter similar to that in <code>par</code>, to monitor the limits of the
vertical axis</p>
</dd> <dt>xlab, ylab</dt><dd><p>Labels for the axes of the serial interval
distribution plot</p>
</dd></dl>
</td></tr>
<tr valign="top"><td><code>legend</code></td>
<td>
<p>A boolean (TRUE by default) governing the presence / absence of
legends on the plots</p>
</td></tr>
<tr valign="top"><td><code>...</code></td>
<td>
<p>further arguments passed to other methods (currently unused).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a plot (if <code>what = "incid"</code>, <code>"R"</code>, or <code>"SI"</code>) or a
<code><a href="../../grid/html/grob.html">grob</a></code> object (if <code>what = "all"</code>).
</p>


<h3>Author(s)</h3>

<p>Rolina van Gaalen <a href="mailto:rolina.van.gaalen@rivm.nl">rolina.van.gaalen@rivm.nl</a> and Anne Cori
<a href="mailto:a.cori@imperial.ac.uk">a.cori@imperial.ac.uk</a>; S3 method by Thibaut Jombart
</p>


<h3>See Also</h3>

<p><code><a href="estimate_R.html">estimate_R</a></code>, 
<code><a href="wallinga_teunis.html">wallinga_teunis</a></code> and 
<code><a href="estimate_R_plots.html">estimate_R_plots</a></code>
</p>


<h3>Examples</h3>

<pre>
## load data on pandemic flu in a school in 2009
data("Flu2009")

## estimate the instantaneous reproduction number
## (method "non_parametric_si")
R_i &lt;- estimate_R(Flu2009$incidence,
                  method = "non_parametric_si",
                  config = list(t_start = seq(2, 26), 
                                t_end = seq(8, 32), 
                                si_distr = Flu2009$si_distr
                               )
                 )

## visualise results
plot(R_i, legend = FALSE)

## estimate the instantaneous reproduction number
## (method "non_parametric_si")
R_c &lt;- wallinga_teunis(Flu2009$incidence, 
                       method = "non_parametric_si",
                       config = list(t_start = seq(2, 26), 
                                     t_end = seq(8, 32), 
                                     si_distr = Flu2009$si_distr
                                    )
                      )

## produce plot of the incidence
## (with, on top of total incidence, the incidence of imported cases),
## estimated instantaneous and case reproduction numbers
## and serial interval distribution used
p_I &lt;- plot(R_i, "incid", add_imported_cases=TRUE) # plots the incidence
p_SI &lt;- plot(R_i, "SI") # plots the serial interval distribution
p_Ri &lt;- plot(R_i, "R",
             options_R = list(ylim = c(0, 4)))
        # plots the estimated instantaneous reproduction number
p_Rc &lt;- plot(R_c, "R",
             options_R = list(ylim = c(0, 4)))
        # plots the estimated case reproduction number
gridExtra::grid.arrange(p_I, p_SI, p_Ri, p_Rc, ncol = 2)

</pre>

<hr /><div style="text-align: center;">[Package <em>EpiEstim</em> version 2.2-1 <a href="00Index.html">Index</a>]</div>
</body></html>
