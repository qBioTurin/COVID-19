<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Graphical comparison of multiple fitted distributions for...</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for graphcompcens {fitdistrplus}"><tr><td>graphcompcens {fitdistrplus}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>Graphical comparison of multiple fitted distributions for censored data</h2>

<h3>Description</h3>

   
<p><code>cdfcompcens</code> plots the empirical cumulative distribution against fitted distribution functions,
<code>qqcompcens</code> plots theoretical quantiles against empirical ones,
<code>ppcompcens</code> plots theoretical probabilities against empirical ones.
</p>


<h3>Usage</h3>

<pre>
cdfcompcens(ft, xlim, ylim, xlogscale = FALSE, ylogscale = FALSE, main, xlab, ylab, 
    datacol, fillrect, fitlty, fitcol, addlegend = TRUE, legendtext, 
    xlegend = "bottomright", ylegend = NULL, lines01 = FALSE, 
    Turnbull.confint = FALSE, NPMLE.method = "Wang", add = FALSE, 
    plotstyle = "graphics", ...)
qqcompcens(ft, xlim, ylim, xlogscale = FALSE, ylogscale = FALSE, main, xlab, ylab,
      fillrect, fitcol, addlegend = TRUE, legendtext, xlegend = "bottomright", 
      ylegend = NULL, line01 = TRUE, line01col = "black", line01lty = 1, 
      ynoise = TRUE, plotstyle = "graphics", ...)
ppcompcens(ft, xlim, ylim, xlogscale = FALSE, ylogscale = FALSE, main, xlab, ylab, 
      fillrect, fitcol, addlegend = TRUE, legendtext, xlegend = "bottomright", 
      ylegend = NULL, line01 = TRUE, line01col = "black", line01lty = 1, 
      ynoise = TRUE, plotstyle = "graphics", ...)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>ft</code></td>
<td>
<p>One <code>"fitdistcens"</code> object or a list of objects of class <code>"fitdistcens"</code>.</p>
</td></tr>
<tr valign="top"><td><code>xlim</code></td>
<td>
<p>The <i>x</i>-limits of the plot.</p>
</td></tr>
<tr valign="top"><td><code>ylim</code></td>
<td>
<p>The <i>y</i>-limits of the plot.</p>
</td></tr>
<tr valign="top"><td><code>xlogscale</code></td>
<td>
<p>If <code>TRUE</code>, uses a logarithmic scale for the <i>x</i>-axis.</p>
</td></tr>
<tr valign="top"><td><code>ylogscale</code></td>
<td>
<p>If <code>TRUE</code>, uses a logarithmic scale for the <i>y</i>-axis.</p>
</td></tr>
<tr valign="top"><td><code>main</code></td>
<td>
<p>A main title for the plot, see also <code><a href="../../graphics/html/title.html">title</a></code>.</p>
</td></tr>
<tr valign="top"><td><code>xlab</code></td>
<td>
<p>A label for the <i>x</i>-axis, defaults to a description of <code>x</code>.</p>
</td></tr>
<tr valign="top"><td><code>ylab</code></td>
<td>
<p>A label for the <i>y</i>-axis, defaults to a description of <code>y</code>.</p>
</td></tr>
<tr valign="top"><td><code>datacol</code></td>
<td>
<p>A specification of the color to be used in plotting data points.</p>
</td></tr>
<tr valign="top"><td><code>fillrect</code></td>
<td>
<p>A specification of the color to be used for filling rectanges
of non uniqueness of the empirical cumulative distribution 
(only used if <code>NPMLE.method</code> is equal to <code>"Wang"</code> in <code>cdfcompcens</code>).
Fix it to <code>NA</code> if you do not want to fill the rectangles.</p>
</td></tr>
<tr valign="top"><td><code>fitcol</code></td>
<td>
<p>A (vector of) color(s) to plot fitted distributions. 
If there are fewer colors than fits they are recycled in the standard fashion.</p>
</td></tr>
<tr valign="top"><td><code>fitlty</code></td>
<td>
<p>A (vector of) line type(s) to plot fitted distributions. 
If there are fewer colors than fits they are recycled in the standard fashion.
See also <code><a href="../../graphics/html/par.html">par</a></code>.</p>
</td></tr>
<tr valign="top"><td><code>addlegend</code></td>
<td>
<p>If <code>TRUE</code>, a legend is added to the plot.</p>
</td></tr>
<tr valign="top"><td><code>legendtext</code></td>
<td>
<p>A character or expression vector of length <i>&ge;q 1</i> to appear
in the legend, see also <code><a href="../../graphics/html/legend.html">legend</a></code>.</p>
</td></tr>
<tr valign="top"><td><code>xlegend, ylegend</code></td>
<td>
<p>The <i>x</i> and <i>y</i> coordinates to be used to position the legend.
They can be specified by keyword.
If <code>plotstyle = "graphics"</code>, see <code><a href="../../grDevices/html/xy.coords.html">xy.coords</a></code> and <code><a href="../../graphics/html/legend.html">legend</a></code>.
If <code>plotstyle = "ggplot"</code>, the <code>xlegend</code> keyword must be one of <code>top</code>, <code>bottom</code>, 
<code>left</code>, or <code>right</code>. See also <code>guide_legend</code> in <code>ggplot2</code></p>
</td></tr>
<tr valign="top"><td><code>lines01</code></td>
<td>
<p>A logical to plot two horizontal lines at <code>h=0</code> and <code>h=1</code>
for <code>cdfcompcens</code>.</p>
</td></tr>
<tr valign="top"><td><code>Turnbull.confint</code></td>
<td>
<p> if TRUE confidence intervals will be added to the Turnbull plot.
In that case NPMLE.method is forced to <code>"Turnbull"</code></p>
</td></tr>
<tr valign="top"><td><code>NPMLE.method</code></td>
<td>
<p>Two NPMLE techniques are provided, <code>"Wang"</code>, the default one,
which is implemented in the package npsurv and <code>"Turnbull"</code>, an older one,
which is implemented in the package survival (see details). Only <code>"Wang"</code>
enables the derivation of a Q-Q plot and a P-P plot.</p>
</td></tr>
<tr valign="top"><td><code>add</code></td>
<td>
<p>If <code>TRUE</code>, adds to an already existing plot. If <code>FALSE</code>, starts a new plot.
This parameter is not available when <code>plotstyle = "ggplot"</code>.</p>
</td></tr>
<tr valign="top"><td><code>line01</code></td>
<td>
<p>A logical to plot an horizontal line <i>y=x</i> for 
<code>qqcompcens</code> and <code>ppcompcens</code>.</p>
</td></tr>
<tr valign="top"><td><code>line01col, line01lty</code></td>
<td>
<p>Color and line type for <code>line01</code>. See also <code><a href="../../graphics/html/par.html">par</a></code>.</p>
</td></tr>
<tr valign="top"><td><code>ynoise</code></td>
<td>
<p>A logical to add a small noise when plotting empirical 
quantiles/probabilities for <code>qqcompcens</code> and <code>ppcompcens</code>. <code>ynoise</code> is only 
used when various
fits are plotted with the <code>"graphics"</code> <code>plotstyle</code>. 
Facets are used instead with the <code>"ggplot"</code> <code>plotstyle</code>.</p>
</td></tr>
<tr valign="top"><td><code>plotstyle</code></td>
<td>
<p><code>"graphics"</code> or <code>"ggplot"</code>. 
If <code>"graphics"</code>, the display is built with <code><a href="../../graphics/html/graphics-package.html">graphics</a></code> functions.
If <code>"ggplot"</code>, a graphic object output is created with <code>ggplot2</code> functions.
In <code>"cdfcompcens"</code>, <code>"ggplot"</code> graphics are only available with <code>"Wang"</code> NPMLE technique.</p>
</td></tr>
<tr valign="top"><td><code>...</code></td>
<td>
<p>Further graphical arguments passed to graphical functions used in <code>cdfcompcens</code>, <code>ppcompcens</code> 
and <code>qqcompcens</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See details of <code><a href="plotdistcens.html">plotdistcens</a></code> for a detailed description of provided goddness-of-fit plots.
</p>


<h3>Author(s)</h3>

 
<p>Marie-Laure Delignette-Muller and Christophe Dutang.
</p>


<h3>References</h3>

 
<p>Turnbull BW (1974), <em>Nonparametric estimation of a survivorship function with doubly
censored data</em>.
Journal of American Statistical Association, 69, 169-173.
</p>
<p>Wang Y (2008), <em>Dimension-reduced nonparametric maximum likelihood computation
for interval-censored data</em>. Computational Statistics &amp; Data Analysis, 52, 2388-2402.
</p>
<p>Wang Y and Taylor SM (2013), <em>Efficient computation of nonparametric survival
functions via a hierarchical mixture formulation</em>. Statistics and Computing, 23, 713-725.
</p>
<p>Delignette-Muller ML and Dutang C (2015), <em>fitdistrplus: An R Package for Fitting Distributions</em>.
Journal of Statistical Software, 64(4), 1-34.
</p>


<h3>See Also</h3>

 
<p><code><a href="plotdistcens.html">plotdistcens</a></code>, <code><a href="../../survival/html/survfit.formula.html">survfit.formula</a></code>, <code><a href="../../graphics/html/legend.html">legend</a></code> and <code><a href="../../graphics/html/par.html">par</a></code>.
</p>


<h3>Examples</h3>

<pre>
# (1) Plot various distributions fitted to bacterial contamination data
#
data(smokedfish)
Clog10 &lt;- log10(smokedfish)

fitsfn &lt;- fitdistcens(Clog10,"norm")
summary(fitsfn)

fitsfl &lt;- fitdistcens(Clog10,"logis")
summary(fitsfl)

dgumbel &lt;- function(x,a,b) 1/b*exp((a-x)/b)*exp(-exp((a-x)/b))
pgumbel &lt;- function(q,a,b) exp(-exp((a-q)/b))
qgumbel &lt;- function(p,a,b) a-b*log(-log(p))
fitsfg&lt;-fitdistcens(Clog10,"gumbel",start=list(a=-3,b=3))
summary(fitsfg)

# CDF plot
cdfcompcens(list(fitsfn,fitsfl,fitsfg))
cdfcompcens(list(fitsfn,fitsfl,fitsfg),datacol="orange",fillrect = NA, 
    legendtext=c("normal","logistic","Gumbel"),
    main="bacterial contamination fits",
    xlab="bacterial concentration (CFU/g)",ylab="F",
    xlegend = "bottom",lines01 = TRUE)
# alternative Turnbull plot for the empirical cumulative distribution
# (default plot of the previous versions of the package)
cdfcompcens(list(fitsfn,fitsfl,fitsfg), NPMLE.method = "Turnbull")

# customizing graphical output with ggplot2
if (requireNamespace ("ggplot2", quietly = TRUE)) {
  cdfcompcens &lt;- cdfcompcens(list(fitsfn,fitsfl,fitsfg),datacol="orange",fillrect = NA, 
    legendtext=c("normal","logistic","Gumbel"),
    xlab="bacterial concentration (CFU/g)",ylab="F",
    xlegend = "bottom",lines01 = TRUE, plotstyle = "ggplot")
  cdfcompcens + ggplot2::theme_minimal() + ggplot2::ggtitle("Bacterial contamination fits")
}

# PP plot
ppcompcens(list(fitsfn,fitsfl,fitsfg))
ppcompcens(list(fitsfn,fitsfl,fitsfg), ynoise = FALSE)
par(mfrow = c(2,2))
ppcompcens(fitsfn)
ppcompcens(fitsfl)
ppcompcens(fitsfg)
par(mfrow = c(1,1))
if (requireNamespace ("ggplot2", quietly = TRUE)) {
  ppcompcens(list(fitsfn,fitsfl,fitsfg), plotstyle = "ggplot")
  ppcompcens(list(fitsfn,fitsfl,fitsfg), plotstyle = "ggplot", 
    fillrect = c("lightpink", "lightblue", "lightgreen"), 
    fitcol = c("red", "blue", "green"))
}

# QQ plot
qqcompcens(list(fitsfn,fitsfl,fitsfg))
qqcompcens(list(fitsfn,fitsfl,fitsfg), ynoise = FALSE)
par(mfrow = c(2,2))
qqcompcens(fitsfn)
qqcompcens(fitsfl)
qqcompcens(fitsfg)
par(mfrow = c(1,1))

if (requireNamespace ("ggplot2", quietly = TRUE)) {
  qqcompcens(list(fitsfn,fitsfl,fitsfg), ynoise = FALSE, plotstyle = "ggplot")
  qqcompcens(list(fitsfn,fitsfl,fitsfg), ynoise = FALSE, plotstyle = "ggplot", 
    fillrect = c("lightpink", "lightblue", "lightgreen"), 
    fitcol = c("red", "blue", "green"))
}

</pre>

<hr /><div style="text-align: center;">[Package <em>fitdistrplus</em> version 1.0-14 <a href="00Index.html">Index</a>]</div>
</body></html>
